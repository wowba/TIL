## ëª©ì°¨

4. [ORM, JPA ì˜ì†ì„±, DB](4ì¥-ORM,-JPA-ì˜ì†ì„±,-DB)

# 4ì¥ ORM, JPA ì˜ì†ì„±, DB

- 1. ORMì´ë€?
     ğŸ’¡ ORM: Object-Relational Mapping

  Object: **"ê°ì²´"**ì§€í–¥ ì–¸ì–´ (ìë°”, íŒŒì´ì¬)
  Relational: **"ê´€ê³„í˜•"** ë°ì´í„°ë² ì´ìŠ¤ (H2, MySQL)

- 2. JPAëŠ”?

  ğŸ’¡ JPA: Java Persistence API
  ìë°” ORM ê¸°ìˆ ì— ëŒ€í•œ í‘œì¤€ ëª…ì„¸

## JPA ì˜ì†ì„± ì»¨í…ŒìŠ¤íŠ¸

- JPA
  - **ê°ì²´** - ORM - **DB**
  - **ê°ì²´** - **ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì ¸** (entity context manager) - **DB**
- ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì ¸
  - ê°ì²´ â†” DB ì˜ ì†Œí†µì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬
- PK (Primary Key)
  - í…Œì´ë¸”ì—ì„œ ê° row ë§ˆë‹¤ ê°€ì ¸ì•¼ í•˜ëŠ” ìœ ì¼ë¬´ì´í•œ ê°’ (Null í—ˆìš©ë˜ì§€ ì•ŠìŒ)
  - ë³´í†µ í…Œì´ë¸” ID ë¥¼ PK ë¡œ ì„¤ì • (ì¸ì¡°í‚¤)

## DBì˜ ì—°ê´€ê´€ê³„

- DB ì˜ ì—°ê´€ê´€ê³„

  - JPA ê°€ ì œê³µí•˜ëŠ” ì—°ê´€ê´€ê³„ëŠ” ê²°êµ­ DB ì˜ ì—°ê´€ê´€ê³„ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•¨
  - ë”°ë¼ì„œ ë¨¼ì € DB ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì´í•´í•´ì•¼ í•¨
  - DB ì˜ ì—°ê´€ê´€ê³„ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì— ë§ì¶° ì´ë£¨ì–´ì§

- 'ìŒì‹ ë°°ë‹¬ ì„œë²„'ë¥¼ ê°œë°œí•œë‹¤ê³  ê°€ì •

  - íšŒì› 1ëª…ì€ ì£¼ë¬¸ Nê°œë¥¼ í•  ìˆ˜ ìˆë‹¤.
    - íšŒì› : ì£¼ë¬¸ = 1 : N ê´€ê³„
  - ìŒì‹ 1ê°œëŠ” ì£¼ë¬¸ Nê°œì— í¬í•¨ë  ìˆ˜ ìˆë‹¤.
    - ìŒì‹ : ì£¼ë¬¸ = 1 : N ê´€ê³„
  - ê²°ë¡ ì ìœ¼ë¡œ
    - íšŒì› : ìŒì‹ = N : N ê´€ê³„

## JPA ì—°ê´€ê´€ê³„

- JPA ì—°ê´€ê´€ê³„ ì„¤ì •ë°©ë²•
  ğŸ‘‰ JPA ì˜ ê²½ìš°ëŠ” Enitity í´ë˜ìŠ¤ì˜ í•„ë“œ ìœ„ì— ì—°ê´€ê´€ê³„ ì–´ë…¸í…Œì´ì…˜ (@) ì„ ì„¤ì •í•´ ì£¼ëŠ” ê²ƒë§Œìœ¼ë¡œ ì—°ê´€ê´€ê³„ê°€ í˜•ì„±ë©ë‹ˆë‹¤.

- 'ìŒì‹ ë°°ë‹¬ ì„œë²„'ë¥¼ ê°œë°œí•œë‹¤ê³  ê°€ì •

  - @OneToMany / Order(1) : Food(N) --> ë°°ë‹¬ì£¼ë¬¸ 1ê°œì— ìŒì‹ ì—¬ëŸ¬ê°œ ì„ íƒ
  - @ManyToOne / Owner(1) : Restaurant(N) --> ìŒì‹ì  ì£¼ì¸ ì—¬ëŸ¬ëª…ì´ í•˜ë‚˜ì˜ ê°€ê²Œ ì†Œìœ 
  - @OneToOne / Order(1) : Coupon(1) --> ë°°ë‹¬ ì£¼ë¬¸ 1ê°œì— ì¿ í° 1ê°œë§Œ ì ìš© ê°€ëŠ¥
  - @ManyToMany / User(N) : Restaurant(N) --> ê³ ê°ì´ ìŒì‹ì  ì—¬ëŸ¬ê°œ ì°œ ê°€ëŠ¥ / ìŒì‹ì ì€ ê³ ê° ì—¬ëŸ¬ëª…ì—ê²Œ ì°œ ê°€ëŠ¥

- ì£¼ë¬¸ (Order)

```
@Enitity
public class Order {
    @OneToMany
    private List<Food> foods;

		@OneToOne
		private Coupon coupon;
}
```

- ìŒì‹ì ì£¼ (Owner)

```
@Entity
public class Owner {
	@ManyToOne
	Restaurant restaurant;
}
```

- ê³ ê° (User)

```
@Entity
public class User {
	@ManyToMany
	List<Restaurant> likeRestaurants;
}
```

## Spring Data JPA ì´í•´

- Spring Data JPA ëŠ”?
  - JPA ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•´, ìŠ¤í”„ë§ì—ì„œ JPA ë¥¼ Wrapping
  - ìŠ¤í”„ë§ ê°œë°œìë“¤ì´ JPA ë¥¼ ì‚¬ìš©í•  ë•Œ í•„ìˆ˜ì ìœ¼ë¡œ ìƒì„±í•´ì•¼ í•˜ë‚˜, ì˜ˆìƒ ê°€ëŠ¥í•˜ê³  ë°˜ë³µì ì¸ ì½”ë“œë“¤ â†’ Spring Data JPA ê°€ ëŒ€ì‹  ì‘ì„±
  - Repostiory ì¸í„°í˜ì´ìŠ¤ë§Œ ì‘ì„±í•˜ë©´, í•„ìš”í•œ êµ¬í˜„ì€ ìŠ¤í”„ë§ì´ ëŒ€ì‹  ì•Œì•„ì„œ ì²™ì²™!
